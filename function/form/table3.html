<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>张三数据1</title>
  </head>
  <body>
    <p style="font-size: 20px; color: red">
      使用table标签方式将json导出xls文件
    </p>
    <button onclick="tableToExcel()">张三数据2</button>
    <script>
      const tableToExcel = () => {
        // 要导出的json数据
        const jsonData = [
          {
            name: "路人甲",
            phone: "123456",
            email: "123@123456.com",
          },
          {
            name: "炮灰乙",
            phone: "123456",
            email: "123@123456.com",
          },
          {
            name: "土匪丙",
            phone: "123456",
            email: "123@123456.com",
          },
          {
            name: "流氓丁",
            phone: "123456",
            email: "123@123456.com",
          },
        ];
        // 列标题
        let str = `<tr>
            <th style="width: 500px;">姓名</th>
            <th>电话</th>
            <th>邮箱</th>
          </tr>`;
        // 循环遍历，每行加入tr标签，每个单元格加td标签
        for (let i = 0; i < jsonData.length; i++) {
          str += "<tr>";
          for (const key in jsonData[i]) {
            // 增加\t为了不让表格显示科学计数法或者其他格式
            str += `<td>${jsonData[i][key] + "\t"}</td>`;
          }
          str += "</tr>";
        }
        // Worksheet名
        const worksheet = "Sheet1";
        const uri = "data:application/vnd.ms-excel;base64,";
        // 下载的表格模板数据
        // const template = `<table>${str}</table>`;
        let template =`<table>${str}</table>`;

        window.location.href = uri + base64(template);
      };

      // 输出base64编码
      const base64 = (s) => window.btoa(unescape(encodeURIComponent(s)));
    </script>
  </body>
</html>
